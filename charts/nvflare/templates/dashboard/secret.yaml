{{- if .Values.dashboard.enabled -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "nvflare.dashboard.fullname" . }}
  labels:
    {{- include "nvflare.dashboard.labels" . | nindent 4 }}
data:
  {{- if not .Release.IsUpgrade }}
  NVFL_CREDENTIAL: {{ printf "dashboard@cluster.local:%s" (randAlphaNum 60) | b64enc }}
  NVFL_PROJ_ADMIN_CREDENTIAL: {{ printf "%s:%s" .Values.project.admin (randAlphaNum 50) | b64enc }}
  {{- else }}
  NVFL_CREDENTIAL: {{ index (lookup "v1" "Secret" .Release.Namespace (include "nvflare.dashboard.fullname" .)).data "NVFL_CREDENTIAL" }}
  NVFL_PROJ_ADMIN_CREDENTIAL: {{ index (lookup "v1" "Secret" .Release.Namespace (include "nvflare.dashboard.fullname" .)).data "NVFL_PROJ_ADMIN_CREDENTIAL" }}
  {{- end }}
{{- end }}
